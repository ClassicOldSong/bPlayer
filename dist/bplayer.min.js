"use strict";!function(){var e='<div class="info_bplayer"><div class="titlewrap_bplayer"><span class="title_bplayer">Unknown Title</span><span class="author_bplayer">Unknown Artist</span></div><div class="time_bplayer"><span class="current_bplayer">0:00</span><span class="total_bplayer">0:00</span></div><div class="buttons_bplayer"><div class="disabled_bplayer btn_bplayer" id="loopBtn_bplayer"><i class="iconfont_bplayer">&#xe600;</i></div><div class="volume_bplayer"><div class="volumebtn_bplayer btn_bplayer" id="volumeBtn_bplayer"><i class="iconfont_bplayer">&#xe602;</i></div><div class="volumebar_bplayer"><div class="volumebg_bplayer"></div><div class="volumeval_bplayer"></div><div class="volumectl_bplayer"></div></div></div></div></div><div class="cover_bplayer"><div class="coverimg_bplayer"></div><div class="controlbtn_bplayer playBtn_bplayer" id="playBtn_bplayer"><i class="iconfont_bplayer">&#xe601;</i></div><div class="controlbtn_bplayer hidden_bplayer" id="pauseBtn_bplayer"><i class="iconfont_bplayer">&#xe603;</i></div></div><div class="progress_bplayer"><div class="loaded_bplayer"></div><div class="played_bplayer"></div><div class="progressctl_bplayer"></div></div>',t=function(e){var t=new Date(1e3*e),n=t.getSeconds();return 10>n&&(n="0"+n),t.getMinutes()+":"+n},n=function(e,t){var n=e.parentNode;n.replaceChild(t,e)},r=function(){this.clientWidth<=460?this.classList.add("narrow_bplayer"):this.classList.remove("narrow_bplayer")},o=function(o){var i=this;if(!o)return i;var a={volumedown:!1,progressdown:!1,slim:!1,cover:""},l=document.createElement("bplayer");l.innerHTML=e;var s=l.querySelector(".coverimg_bplayer"),u=l.querySelector(".progressctl_bplayer"),c=l.querySelector(".volumectl_bplayer"),d=l.querySelector(".title_bplayer"),p=l.querySelector(".author_bplayer"),v=l.querySelector(".played_bplayer"),y=l.querySelector(".current_bplayer"),f=l.querySelector(".loaded_bplayer"),m=l.querySelector(".total_bplayer"),b=l.querySelector(".volumeval_bplayer"),h=l.querySelector(".cover_bplayer"),_=l.querySelector("#volumeBtn_bplayer"),g=l.querySelector("#loopBtn_bplayer"),w=l.querySelector("#playBtn_bplayer"),L=l.querySelector("#pauseBtn_bplayer");if(this.element=l,"string"==typeof o&&(o=document.querySelector(o)),!o||null===o.nodeType)throw new Error("Invalid element.");if("BPLAYER"===o.nodeName.toUpperCase())throw new Error("bPlayer already attached.");var E;return E="AUDIO"===o.nodeName.toUpperCase()?o:document.createElement("audio"),this.addEvent=function(e,t,n){return"function"==typeof t?E.addEventListener(e,t,!!n):console.warn(t,"is not a function!"),i},this.removeEvent=function(e,t,n){return"function"==typeof t?E.removeEventListener(e,t,!!n):console.warn(t,"is not a function!"),i},this.slim=function(e){return e===!0?(l.classList.add("slim_bPlayer"),a.slim=!0,i):e===!1?(l.classList.remove("slim_bPlayer"),a.slim=!1,i):a.slim},this.src=function(e){return e||""===e?(E.src=e,E.autoplay||i.pause(),y.textContent="0:00",m.textContent="0:00",v.style.width=0,f.style.width=0,i):E.src},this.cover=function(e){return e||""===e?(s.style.backgroundImage='url("'+e+'")',a.cover=e,i):a.cover},this.title=function(e){return e||""===e?(l.setAttribute("title",e),d.textContent=e,i):d.textContent},this.artist=function(e){return e||""===e?(p.textContent=e,i):p.textContent},this.color=function(e){return e||""===e?(v.style.backgroundColor=e,b.style.backgroundColor=e,i):v.style.backgroundColor},this.volume=function(e){return e||""===e?(E.volume=e,i):E.volume},this.muted=function(e){return e===!1?(E.muted=e,_.classList.remove("disabled_bplayer"),i):e===!0?(E.muted=e,_.classList.add("disabled_bplayer"),i):E.muted},this.loop=function(e){return e===!1?(E.loop=e,g.classList.add("disabled_bplayer"),i):e===!0?(E.loop=e,g.classList.remove("disabled_bplayer"),i):E.loop},this.autoplay=function(e){return e===!1?(E.autoplay=e,i):e===!0?(E.autoplay=e,i):E.autoplay},this.play=function(){return""!==this.src()&&null!==this.src()&&E.play(),i},this.pause=function(){return E.pause(),w.classList.remove("hidden_bplayer"),L.classList.add("hidden_bplayer"),i},this.init=function(){if("undefined"==typeof l.inited){for(var e=0;e<o.attributes.length;e++)/(src|artist|slim|cover|color|autoplay|loop)/i.test(o.attributes[e].name)||l.setAttribute(o.attributes[e].name,o.attributes[e].value);l.classList.add("bPlayer"),n(o,l),r.call(l),l.inited=!0}else console.warn(l,"has already been initialized!");return i},this.paused=function(){return E.paused},Object.defineProperties(l,{slim:{get:function(){return i.slim()},set:function(e){i.slim(e)}},src:{get:function(){return i.src()},set:function(e){i.src(e)}},cover:{get:function(){return i.cover()},set:function(e){i.cover(e)}},title:{get:function(){return i.title()},set:function(e){i.title(e)}},artist:{get:function(){return i.artist()},set:function(e){i.artist(e)}},color:{get:function(){return i.color()},set:function(e){i.color(e)}},volume:{get:function(){return i.volume()},set:function(e){i.volume(e)}},muted:{get:function(){return i.muted()},set:function(e){i.muted(e)}},loop:{get:function(){return i.loop()},set:function(e){i.loop(e)}},autoplay:{get:function(){return i.autoplay()},set:function(e){i.autoplay(e)}},paused:{get:function(){return E.paused}},addEvent:{value:i.addEvent},removeEvent:{value:i.removeEvent}}),window.addEventListener("resize",function(){r.call(l)}),u.addEventListener("click",function(e){var t=this.clientWidth,n=e.offsetX;try{E.currentTime=n/t*E.duration}catch(r){}}),u.addEventListener("mousedown",function(){a.progressdown=!0}),u.addEventListener("mouseup",function(){a.progressdown=!1}),u.addEventListener("mouseout",function(){a.progressdown=!1}),u.addEventListener("mousemove",function(e){if(a.progressdown){var t=this.clientWidth,n=e.offsetX;try{E.currentTime=n/t*E.duration}catch(r){}}}),u.addEventListener("touchstart",function(){a.progressdown=!0}),u.addEventListener("touchend",function(){a.progressdown=!1}),u.addEventListener("touchmove",function(e){if(a.progressdown){var t=this.clientWidth,n=e.touches[0].pageX-e.target.getBoundingClientRect().left;try{E.currentTime=n/t*E.duration}catch(r){}}}),c.addEventListener("click",function(e){var t=e.offsetX+1;t>=0&&(E.volume=t/80)}),c.addEventListener("mousedown",function(){a.volumedown=!0}),c.addEventListener("mouseup",function(){a.volumedown=!1}),c.addEventListener("mouseout",function(){a.volumedown=!1}),c.addEventListener("mousemove",function(e){if(a.volumedown){var t=e.offsetX+1;try{E.volume=t/80}catch(n){}}}),c.addEventListener("touchstart",function(){a.volumedown=!0}),c.addEventListener("touchend",function(){a.volumedown=!1}),c.addEventListener("touchmove",function(e){if(a.volumedown){var t=e.touches[0].pageX-e.target.getBoundingClientRect().left+1;try{E.volume=t/80}catch(n){}}}),_.addEventListener("click",function(){i.muted(!i.muted())}),h.addEventListener("click",function(){E.paused?i.play():i.pause()}),g.addEventListener("click",function(){i.loop()?i.loop(!1):i.loop(!0)}),E.addEventListener("timeupdate",function(){v.style.width=this.currentTime/this.duration*100+"%",y.textContent=t(this.currentTime)}),E.addEventListener("progress",function(){try{f.style.width=this.buffered.end(this.length-1)/this.duration*100+"%",m.textContent=t(this.duration)}catch(e){}}),E.addEventListener("volumechange",function(){b.style.width=80*this.volume+"px"}),E.addEventListener("play",function(){w.classList.add("hidden_bplayer"),L.classList.remove("hidden_bplayer"),m.textContent=t(this.duration)}),E.addEventListener("ended",function(){i.loop()||i.pause()}),i},i=function(e){if(!e)return'bPlayer - Ver 0.2.0a \n Please use "new" to create a bPlayer element.';if("undefined"==typeof e.element)throw new Error("[bPlayer] 'element' is not defined in configuration!");var t={src:"",cover:"",title:"",artist:"",color:"#F00",volume:"1",muted:!1,autoplay:!1,loop:!1,slim:!1};for(var n in e)t[n]=e[n];this.attach(t.element).autoplay(t.autoplay).cover(t.cover).title(t.title).artist(t.artist).color(t.color).volume(t.volume).slim(t.slim).muted(t.muted).loop(t.loop).src(t.src).init(),t.autoplay&&this.play()};i.prototype.attach=o;var a=function(){document.removeEventListener("DOMContentLoaded",a,!1);for(var e=document.querySelectorAll("audio"),t=0;t<e.length;t++)if(e[t].hasAttribute("controls")){var n="",r="",o="",l="#F00",s=!1,u=!1,c=!1;e[t].hasAttribute("title")&&(n=e[t].getAttribute("title")),e[t].hasAttribute("artist")&&(r=e[t].getAttribute("artist")),e[t].hasAttribute("cover")&&(o=e[t].getAttribute("cover")),e[t].hasAttribute("color")&&(l=e[t].getAttribute("color")),e[t].hasAttribute("slim")&&"false"!==e[t].getAttribute("slim")&&(s=!0),e[t].hasAttribute("autoplay")&&"false"!==e[t].getAttribute("autoplay")&&(u=!0),e[t].hasAttribute("loop")&&"false"!==e[t].getAttribute("loop")&&(c=!0);var d=new i;d.attach(e[t]).autoplay(u).loop(c).title(n).artist(r).cover(o).color(l).slim(s).init(),u&&d.play()}};i.scan=a,"undefined"!=typeof module&&module.exports?module.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):window.bPlayer=i}();